"use client"
import { Object } from '@/modules/types/Objects'
import ObjectsService from '@/modules/services/ObjectsService'
import Link from 'next/link'
import React from 'react'
import { API_URL } from '@/http/intex'

export default function ObjectCard({ object, my }: { object: Object, my?: boolean }) {

  const [open, setOpen] = React.useState(false)
  const [visible, setVisible] = React.useState(true)

  const deleteObject = async () => {
    setOpen(!open)
    const response = await ObjectsService.delete(object.id)
    if (response.status == 200) return setVisible(false)
  }

  const mapAdress = object.location.address.split('/')[0].split(',')


  return (
    <>
      {visible &&
        <div className="objects-item" >
          <Link href={`/objects/${object.id}`} className="objects-item__preview">
            <div className="objects-image-wrapper full-image">
              {object.photos.length > 0 ?
                <img src={`${API_URL}/storage/images/${object.photos[0]}`} alt="" />
                :
                <div className="one__image-card">
                  <img src="/img/static/object-card.jpg" alt="object-card" />
                </div>
              }
            </div>
            {object.photos.length > 2 &&
              <div className="objects-item__preview-box">
                <div className="objects-image-wrapper">
                  {
                    <img src={`${API_URL}/storage/images/${object.photos[1]}`} alt="" />
                  }
                </div>
                <div className="objects-image-wrapper">
                  {
                    <img src={`${API_URL}/storage/images/${object.photos[2]}`} alt="" />
                  }
                </div>
              </div>
            }

          </Link>
          <div className="objects-item__info">
            <div className="objects-item__title">
              <Link href={`/objects/${object.id}`}>{object.title}</Link>
              {my &&
                <div className="objects-item__menu">
                  <button className="object-items__menu-btn" onClick={() => setOpen(!open)}>
                    <svg width="4" height="14" viewBox="0 0 4 14" fill="none" >
                      <path d="M2.00033 2.99967C1.26395 2.99967 0.666993 2.40272 0.666993 1.66634C0.666993 0.929961 1.26395 0.333008 2.00033 0.333008C2.73671 0.333008 3.33366 0.929961 3.33366 1.66634C3.33366 2.40272 2.73671 2.99967 2.00033 2.99967Z" fill="#2A344A" />
                      <path d="M2.00033 8.33301C1.26395 8.33301 0.666992 7.73605 0.666992 6.99967C0.666992 6.26329 1.26395 5.66634 2.00033 5.66634C2.73671 5.66634 3.33366 6.26329 3.33366 6.99967C3.33366 7.73605 2.7367 8.33301 2.00033 8.33301Z" fill="#2A344A" />
                      <path d="M2.00033 13.6663C1.26395 13.6663 0.666992 13.0694 0.666992 12.333C0.666992 11.5966 1.26395 10.9997 2.00033 10.9997C2.7367 10.9997 3.33366 11.5966 3.33366 12.333C3.33366 13.0694 2.7367 13.6663 2.00033 13.6663Z" fill="#2A344A" />
                    </svg>

                  </button>
                  {open &&
                    <div className="objects-item__menu-list">
                      <button onClick={deleteObject}>Delete</button>
                      <Link href={`/objects/edit/${object.id}`} onClick={() => setOpen(!open)}>Edit</Link>
                    </div>
                  }

                </div>
              }
            </div>


            <div className="objects-item__location">
              <svg width="14" height="16" viewBox="0 0 14 16" fill="none" >
                <path fill-rule="evenodd" clip-rule="evenodd" d="M7 1.625C4.09308 1.625 1.75 3.95491 1.75 6.8125C1.75 8.58031 2.81128 10.4866 4.11856 12.0062C4.76105 12.753 5.43379 13.3719 6.00451 13.7973C6.29057 14.0106 6.53887 14.1662 6.735 14.2649C6.89295 14.3445 6.97688 14.3665 7 14.3727C7.02313 14.3665 7.10705 14.3445 7.265 14.2649C7.46113 14.1662 7.70943 14.0106 7.99549 13.7973C8.56621 13.3719 9.23895 12.753 9.88144 12.0062C11.1887 10.4866 12.25 8.58031 12.25 6.8125C12.25 3.95491 9.90692 1.625 7 1.625ZM0.25 6.8125C0.25 3.11171 3.2795 0.125 7 0.125C10.7205 0.125 13.75 3.11171 13.75 6.8125C13.75 9.11555 12.4113 11.3655 11.0186 12.9844C10.311 13.8069 9.55879 14.5029 8.89201 14.9999C8.55932 15.248 8.23575 15.4555 7.93968 15.6046C7.66727 15.7418 7.33124 15.875 7 15.875C6.66876 15.875 6.33273 15.7418 6.06032 15.6046C5.76425 15.4555 5.44068 15.248 5.10799 14.9999C4.44121 14.5029 3.68895 13.8069 2.98144 12.9844C1.58872 11.3655 0.25 9.11555 0.25 6.8125ZM5.63119 4.67044C6.10725 4.33579 6.64846 4.25 7 4.25C7.35154 4.25 7.89275 4.33579 8.36881 4.67044C8.88741 5.03498 9.25 5.64228 9.25 6.5C9.25 7.35772 8.88741 7.96502 8.36881 8.32957C7.89275 8.66421 7.35154 8.75 7 8.75C6.64846 8.75 6.10725 8.66421 5.63119 8.32957C5.1126 7.96502 4.75 7.35772 4.75 6.5C4.75 5.64228 5.1126 5.03498 5.63119 4.67044ZM6.49381 5.89758C6.3874 5.97238 6.25 6.11508 6.25 6.5C6.25 6.88492 6.3874 7.02762 6.49381 7.10242C6.64275 7.20711 6.85154 7.25 7 7.25C7.14846 7.25 7.35725 7.20711 7.50619 7.10242C7.6126 7.02762 7.75 6.88492 7.75 6.5C7.75 6.11508 7.6126 5.97238 7.50619 5.89758C7.35725 5.79289 7.14846 5.75 7 5.75C6.85154 5.75 6.64275 5.79289 6.49381 5.89758Z" fill="#7786A5" />
              </svg>
              <span>{mapAdress[3]} / {mapAdress[1]}</span>

            </div>
            <div className="objects-item__servises">
              <span>ID {object.id}</span>
              {object.services[0] &&
                <span>{object.services[0]}</span>
              }
              {object.services[1] &&
                <span>{object.services[1]}</span>
              }
            </div>
            <div className="objects-item__specs">
              {object.condition.buildingYear ?
                <div className='item__specs'>
                  <svg width="17" height="17" viewBox="0 0 17 17" fill="none" >
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M4.61061 0.321908C4.25197 0.152603 3.82352 0.291771 3.63282 0.639507L0.748533 5.89909C0.307037 6.70417 0.855221 7.68202 1.75011 7.74674V10.5001V16.0001C1.75011 16.4143 2.08589 16.7501 2.50011 16.7501C2.91432 16.7501 3.25011 16.4143 3.25011 16.0001V14.7501H6.25011V16.0001C6.25011 16.4143 6.58589 16.7501 7.00011 16.7501C7.41432 16.7501 7.75011 16.4143 7.75011 16.0001V14.0001V10.5001V7.75013H8.00011H12.2501V9.25013V11.5001C12.2501 11.9143 12.5859 12.2501 13.0001 12.2501C13.4143 12.2501 13.7501 11.9143 13.7501 11.5001V9.25013V7.75013H14.7697C16.1041 7.75013 16.5101 5.93942 15.3034 5.36976L4.61061 0.321908ZM13.0001 6.25013H13.6546L6.25981 2.75921L8.41817 6.25013H13.0001ZM6.25011 7.75013H3.25011V9.75013H6.25011V7.75013ZM2.50011 6.25013H6.65462L4.32926 2.48911L2.26677 6.25013H2.50011ZM6.25011 13.2501H3.25011V11.2501H6.25011V13.2501Z" fill="#7786A5" />
                  </svg>
                  <span>{object.condition.buildingYear}</span>
                </div>
                :
                ''
              }
              {object.square.common ?
                <div className='item__specs'>
                  <svg width="18" height="17" viewBox="0 0 18 17" fill="none" >
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M0.75 4.75C0.75 2.26472 2.76472 0.25 5.25 0.25H12.75C15.2353 0.25 17.25 2.26472 17.25 4.75V12.25C17.25 14.7353 15.2353 16.75 12.75 16.75H5.25C2.76472 16.75 0.75 14.7353 0.75 12.25V4.75ZM5.25 1.75C3.59315 1.75 2.25 3.09315 2.25 4.75V12.25C2.25 13.9069 3.59315 15.25 5.25 15.25H12.75C14.4069 15.25 15.75 13.9069 15.75 12.25V4.75C15.75 3.09315 14.4069 1.75 12.75 1.75H5.25ZM9.84997 4.5C9.84997 4.08579 10.1858 3.75 10.6 3.75H12.48C13.1814 3.75 13.75 4.31857 13.75 5.01999V6.89996C13.75 7.31418 13.4142 7.64996 13 7.64996C12.5858 7.64996 12.25 7.31418 12.25 6.89996V6.31063L10.7407 7.81985C10.7373 7.82341 10.7339 7.82694 10.7303 7.83044L6.81072 11.75H7.40003C7.81425 11.75 8.15003 12.0858 8.15003 12.5C8.15003 12.9142 7.81425 13.25 7.40003 13.25H5.52001C4.81862 13.25 4.25 12.6814 4.25 11.98V10.1C4.25 9.68582 4.58579 9.35004 5 9.35004C5.41421 9.35004 5.75 9.68582 5.75 10.1V10.6894L9.25912 7.18034C9.26258 7.17674 9.26608 7.17318 9.26962 7.16963L11.1893 5.25H10.6C10.1858 5.25 9.84997 4.91421 9.84997 4.5Z" fill="#7786A5" />
                  </svg>

                  <span>{object.square.common} м²</span>
                </div>
                :
                ''
              }
              {object.rooms.count ?
                <div className='item__specs'>
                  <svg width="18" height="18" viewBox="0 0 18 18" fill="none" >
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M0.75 4.75C0.75 2.4437 2.86907 0.75 5.25 0.75H12.75C15.1309 0.75 17.25 2.4437 17.25 4.75V7V11.25C17.25 13.5563 15.1309 15.25 12.75 15.25C12.3358 15.25 12 14.9142 12 14.5C12 14.0858 12.3358 13.75 12.75 13.75C14.5112 13.75 15.75 12.5335 15.75 11.25V7.75H13.75C13.3358 7.75 13 7.41421 13 7C13 6.58579 13.3358 6.25 13.75 6.25H15.75V4.75C15.75 3.46645 14.5112 2.25 12.75 2.25H5.25C3.48879 2.25 2.25 3.46645 2.25 4.75V6.25H5.25H6H10C10.4142 6.25 10.75 6.58579 10.75 7C10.75 7.41421 10.4142 7.75 10 7.75H6.75V9.25C6.75 9.66421 6.41421 10 6 10C5.58579 10 5.25 9.66421 5.25 9.25V7.75H2.25V11.25C2.25 12.5335 3.48879 13.75 5.25 13.75V12C5.25 11.5858 5.58579 11.25 6 11.25C6.41421 11.25 6.75 11.5858 6.75 12V13.75H8C8.14807 13.75 8.29282 13.7938 8.41603 13.876L11.416 15.876C11.7607 16.1057 11.8538 16.5714 11.624 16.916C11.3943 17.2607 10.9286 17.3538 10.584 17.124L7.77292 15.25H6H5.25C2.86907 15.25 0.75 13.5563 0.75 11.25V7V4.75Z" fill="#7786A5" />
                  </svg>


                  <span>{object.rooms.count}</span>
                </div>
                : ''
              }
              {object.rooms.bedroom ?
                <div className='item__specs'>
                  <svg width="18" height="15" viewBox="0 0 18 15" fill="none" >
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M2.77778 0.75C3.19199 0.75 3.52778 1.08579 3.52778 1.5V2.46429H5.7032C5.82663 2.08768 6.04199 1.74325 6.33343 1.46222C6.8094 1.00325 7.44933 0.75 8.11111 0.75H9.88889C10.5507 0.75 11.1906 1.00325 11.6666 1.46222C11.958 1.74325 12.1734 2.08768 12.2968 2.46429H14.4722V1.5C14.4722 1.08579 14.808 0.75 15.2222 0.75C15.6364 0.75 15.9722 1.08579 15.9722 1.5V3.21429V7.71809C16.3546 7.83387 16.7081 8.03795 16.9999 8.31936C17.4768 8.77923 17.75 9.40888 17.75 10.0714V11.7857C17.75 12.1999 17.4142 12.5357 17 12.5357H15.9722V13.5C15.9722 13.9142 15.6364 14.25 15.2222 14.25C14.808 14.25 14.4722 13.9142 14.4722 13.5V12.5357H3.52778V13.5C3.52778 13.9142 3.19199 14.25 2.77778 14.25C2.36356 14.25 2.02778 13.9142 2.02778 13.5V12.5357H1C0.585786 12.5357 0.25 12.1999 0.25 11.7857V10.0714C0.25 9.40888 0.5232 8.77923 1.0001 8.31936C1.29194 8.03795 1.64542 7.83387 2.02778 7.71809V3.21429V1.5C2.02778 1.08579 2.36356 0.75 2.77778 0.75ZM3.52778 3.96429V7.60714H14.4722V3.96429H11.6667C11.2525 3.96429 10.9167 3.6285 10.9167 3.21429C10.9167 2.96752 10.8153 2.7251 10.6254 2.54199C10.4345 2.35798 10.1701 2.25 9.88889 2.25H8.11111C7.8299 2.25 7.56546 2.35798 7.37463 2.54199C7.18474 2.7251 7.08333 2.96752 7.08333 3.21429C7.08333 3.6285 6.74755 3.96429 6.33333 3.96429H3.52778ZM2.77778 9.10714C2.49657 9.10714 2.23213 9.21512 2.0413 9.39913C1.8514 9.58225 1.75 9.82467 1.75 10.0714V11.0357H2.77778H15.2222H16.25V10.0714C16.25 9.82467 16.1486 9.58225 15.9587 9.39913C15.7679 9.21512 15.5034 9.10714 15.2222 9.10714H2.77778Z" fill="#7786A5" />
                  </svg>



                  <span>{object.rooms.bedroom}</span>
                </div>
                : ''
              }
              {object.rooms.bathroom ?
                <div className='item__specs'>
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" >
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M2.46939 1.45732C2.89898 1.00855 3.48881 0.75 4.11111 0.75C4.73341 0.75 5.32324 1.00855 5.75283 1.45732C6.18137 1.90499 6.41667 2.50542 6.41667 3.125C6.41667 3.53921 6.08088 3.875 5.66667 3.875C5.25245 3.875 4.91667 3.53921 4.91667 3.125C4.91667 2.88262 4.82419 2.65641 4.66927 2.49458C4.51542 2.33386 4.31393 2.25 4.11111 2.25C3.9083 2.25 3.7068 2.33386 3.55295 2.49458C3.39803 2.65641 3.30556 2.88262 3.30556 3.125V5.625H14.2222H15C15.4142 5.625 15.75 5.96079 15.75 6.375C15.75 6.78921 15.4142 7.125 15 7.125H14.9722V9.625C14.9722 10.6756 14.573 11.6893 13.8528 12.4417C13.6238 12.6809 13.3682 12.8875 13.0928 13.0581L13.3961 14.3254C13.4925 14.7283 13.2441 15.133 12.8412 15.2294C12.4384 15.3258 12.0337 15.0774 11.9373 14.6746L11.6758 13.582C11.4901 13.6105 11.3015 13.625 11.1111 13.625H4.88889C4.69854 13.625 4.50986 13.6105 4.32419 13.582L4.06274 14.6746C3.96633 15.0774 3.56161 15.3258 3.15878 15.2294C2.75594 15.133 2.50752 14.7283 2.60393 14.3254L2.90722 13.0581C2.63185 12.8875 2.37622 12.6809 2.14722 12.4417C1.42697 11.6893 1.02778 10.6756 1.02778 9.625V7.125H1C0.585786 7.125 0.25 6.78921 0.25 6.375C0.25 5.96079 0.585786 5.625 1 5.625H1.77778H1.80556V3.125C1.80556 2.50542 2.04086 1.90499 2.46939 1.45732ZM2.52778 7.125V9.625C2.52778 10.2984 2.78414 10.9379 3.23078 11.4045C3.67635 11.8699 4.27352 12.125 4.88889 12.125H11.1111C11.7265 12.125 12.3236 11.8699 12.7692 11.4045C13.2159 10.9379 13.4722 10.2984 13.4722 9.625V7.125H2.55556H2.52778Z" fill="#7786A5" />
                  </svg>
                  <span>{object.rooms.bathroom}</span>
                </div>
                : ""
              }

            </div>
            <div className="objects-item__bottom">
              <span className="objects-item__price">{object.price.cost} {object.price.currency}</span>
              {my ?
                <Link href={`/objects/edit/${object.id}`} className="blue-btn">Edit</Link>
                :
                <Link href={`/objects/${object.id}`} className="blue-btn">Offer</Link>
              }
            </div>
          </div>
        </div>
      }
    </>

  )
}
